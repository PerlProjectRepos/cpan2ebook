<!DOCTYPE html>
<html>
  <head>
    <title><%= $title %></title>
    <link rel="stylesheet" type="text/css" href="main.css">
    <script src="tricks.js" type="text/javascript"></script>

    <link rel="stylesheet" type="text/css" href="development-bundle/themes/ui-lightness/jquery.ui.all.css">
    <script src="development-bundle/jquery-1.7.2.js"></script>
    <script src="development-bundle/ui/jquery.ui.core.js"></script>
    <script src="development-bundle/ui/jquery.ui.widget.js"></script>
    <script src="development-bundle/ui/jquery.ui.position.js"></script>
    <script src="development-bundle/ui/jquery.ui.autocomplete.js"></script>
    <script type="text/javascript">

$( document ).ready( function() {
    $( "#in_text" ).autocomplete({
        source:
        //According to: http://net.tutsplus.com/tutorials/javascript-ajax/how-to-use-the-jquery-ui-autocomplete-widget/
            function(req, add) {
                console.log(req);

                //pass request to server
                $.getJSON(
                    "http://api.metacpan.org/v0/search/autocomplete?",
                    { q: req.term },//req,
                    function(data) {
                        console.log(data)

                        //create array for response objects
                        var suggestions = [];

                        //process response
                        //data.hits.hits[0].fields.distribution

                        data.hits.hits.forEach(function(val, i) {
                         //   suggestions.push(val.fields.distribution);
                            suggestions.push(val.fields.documentation);
                        });

                        //pass array to callback
                        add(suggestions);
                    }
                );
            },

        minLength: 2
    });
});

    </script>
  </head>
  <body>
    <div id="all">
      <div id="navi">
        <a class="navitem" href="/">Home</a>
        <a class="navitem" href="/about">About</a>
      </div>
      <div id="content">
        <%= content %>
      </div>
      <div id="thanks">
        <a href="http://www.perl.org/"><img src="powered_by_perl-135px.png" border="0"></a>
      </div>
    </div>
  </body>
</html>
